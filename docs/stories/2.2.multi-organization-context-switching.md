# Story 2.2: Multi-Organization Context Switching

## Status
InProgress

## Story
**As a** user who belongs to multiple organizations,  
**I want** to quickly switch between organizational contexts with one click,  
**so that** I can show the appropriate aspects of my profile for each group and browse other members within the correct organizational scope.

## Acceptance Criteria

1. **Organization Switcher UI**
   - Current organization is clearly displayed in the main navigation
   - Organization switcher is accessible from all main app views
   - Clicking current org name/logo opens organization selection interface
   - Mobile and desktop versions provide consistent experience

2. **Organization List Display**
   - Shows all organizations user belongs to with logos and names
   - Displays notification indicators (new members, activity, etc.)
   - Current organization is visually highlighted
   - Organizations are ordered by recent activity or user preference

3. **One-Click Switching**
   - Single tap/click immediately switches organizational context
   - Profile view updates to show org-appropriate information
   - Member browse list updates to show correct organizational scope
   - No loading delay or confirmation required for switching

4. **Context Preservation**
   - Switching preserves current view type (Card/List/Modal view)
   - Search filters reset appropriately for new organizational context
   - User's selection state clears when switching organizations
   - URL updates to reflect current organizational context (for bookmarking)

5. **Profile Context Adaptation**
   - User's own profile displays information relevant to current organization
   - Profile fields respect organization-specific visibility settings
   - Profile completeness indicators update for current org context
   - Profile editing maintains organization-specific customizations

## Tasks / Subtasks

- [ ] Create organization switcher component (AC: 1)
  - [ ] Design header/navigation organization indicator
  - [ ] Implement dropdown/modal organization selector
  - [ ] Ensure responsive design for mobile and desktop
  - [ ] Add accessibility support for keyboard navigation

- [ ] Build organization list interface (AC: 2)
  - [ ] Create organization card component with logo, name, activity indicators
  - [ ] Implement notification badges for organization activities
  - [ ] Add visual highlighting for current organization
  - [ ] Implement organization sorting/ordering logic

- [ ] Implement context switching logic (AC: 3, 4)
  - [ ] Create organization context state management
  - [ ] Implement instant context switching without page reload
  - [ ] Update all relevant UI components when context changes
  - [ ] Handle URL routing for organization-specific views

- [ ] Adapt profile system for multi-org context (AC: 5)
  - [ ] Update profile display logic to respect organization context
  - [ ] Modify profile editing to maintain org-specific settings
  - [ ] Update profile completeness calculations per organization
  - [ ] Ensure profile visibility rules work correctly per org

## Dev Notes

**Relevant Architecture Context:**
- Organization context is managed in global application state
- Profile data structure supports organization-scoped visibility settings
- Member filtering and search respect current organizational boundaries
- URL routing includes organization identification for direct access

**Key Integration Points:**
- Integrates with profile display and editing systems
- Works with member browsing and filtering components
- Connects to organization-specific notification systems
- Links with the onboarding organization selection (Story 2.1)

**State Management Considerations:**
- Organization context persists across browser sessions
- Profile cache invalidation when switching organizations
- Real-time updates for organization activity indicators
- Optimistic UI updates for instant switching experience

**API Endpoints Needed:**
- GET /api/user/organizations
- POST /api/user/switch-organization
- GET /api/organizations/{orgId}/members
- GET /api/organizations/{orgId}/activity

**Performance Requirements:**
- Context switching must feel instant (< 100ms)
- Organization list loads quickly even with 50+ organizations
- Profile updates happen without visible delay
- Mobile switching experience matches desktop performance

### Testing
**Testing Standards:**
- Unit tests for organization context switching logic
- Integration tests for profile adaptation across organizations
- E2E tests for complete switching workflow
- Performance tests for large organization lists
- Accessibility tests for keyboard and screen reader support
- Cross-browser compatibility testing

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-08-04 | 1.0 | Initial story creation | Sarah (PO Agent) |

## Dev Agent Record

### Agent Model Used
_To be populated by dev agent_

### Debug Log References
_To be populated by dev agent_

### Completion Notes List
_To be populated by dev agent_

### File List
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_